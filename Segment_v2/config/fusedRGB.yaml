# 训练配置
experiment_name: DJ/Stack_All/Segformer/mit_b0
log_dir: ./logs
checkpoint_dir: ./checkpoints
epochs: 2
batch_size: 4
accumulate_steps: 16  # 梯度累积步数
num_workers: 8
lr: 2e-4
weight_decay: 1e-4
early_stop_patience: 20  # 容忍多少个epoch不提升后停止训练
train_batch_ratio: 1.0 # 选取train dataset 一定比例的数据进行训练
val_batch_ratio: 1.0   # 选取val dataset 一定比例的数据进行训练
test_batch_ratio: 1.0  # 选取test dataset 一定比例的数据进行训练
send_to_wandb: False  # 是否将训练过程发送到wandb
send_to_email: True  # 是否将训练结果发送到邮箱
random_seed: 42  # 设置随机种子，以便每次运行结果可复现
# mean: [0.41177573800086975, 0.4917832911014557, 0.2638063132762909, 0.1071678102016449, 0.0567113496363163, 0.20766067504882812, 0.3984310030937195, 0.5007134079933167, 0.6992559432983398, 0.1481201946735382, 0.924274206161499, 0.6594293117523193, 0.19734691083431244, 0.8408092856407166, 0.5897537469863892, 0.22005736827850342, 0.5413622260093689, 0.027581045404076576, 0.16706962883472443, 0.14436475932598114, 0.40429940819740295, 0.03236877918243408, 0.7147452235221863, 0.03291333094239235, 0.1485392302274704, 0.7811508178710938, 0.5068861246109009, 0.8023850917816162, 0.48957058787345886, 0.03355328366160393, 0.7131638526916504, 0.033717889338731766, 0.15633128583431244, 0.7838436365127563, 0.5063212513923645, 0.8043848872184753, 0.24689221382141113, 0.030129021033644676, 0.7238695621490479, 0.026485715061426163, 0.13523589074611664, 0.7627081274986267, 0.5120993256568909, 0.7955772876739502, 0.8933101296424866] # 自己数据集上的分布
# std:  [0.16751451790332794, 0.16790173947811127, 0.16062752902507782, 0.04346086457371712, 0.03589259460568428, 0.07212314009666443, 0.12606756389141083, 0.13843798637390137, 0.10912247747182846, 0.060984257608652115, 0.038422197103500366, 0.0961407721042633, 0.07297898828983307, 0.10874445736408234, 0.06390856206417084, 0.06787457317113876, 0.09488490968942642, 0.012279191985726357, 0.0353965163230896, 0.044676389545202255, 0.15805290639400482, 0.0324578732252121, 0.29499736428260803, 0.032366860657930374, 0.08530887216329575, 0.18717728555202484, 0.45935577154159546, 0.24762077629566193, 0.15795908868312836, 0.033837947994470596, 0.2961330711841583, 0.03326153755187988, 0.08983787894248962, 0.18667781352996826, 0.45987221598625183, 0.24662074446678162, 0.15161269903182983, 0.029734600335359573, 0.28747180104255676, 0.02571825496852398, 0.07749374955892563, 0.19272029399871826, 0.4543341100215912, 0.2528374493122101, 0.01021671760827303]
# mean: [0.485, 0.456, 0.406, 0.485, 0.456, 0.406, 0.485, 0.456, 0.406, 0.485, 0.456, 0.406, 0.485, 0.456, 0.406] # 自己数据集上的分布
# std: [0.229, 0.224, 0.225, 0.229, 0.224, 0.225, 0.229, 0.224, 0.225, 0.229, 0.224, 0.225, 0.229, 0.224, 0.225]
loss_type: crossentropy_loss # 交叉熵损失函数
optimizer: AdamW
scheduler: Warmup_CosineAnnealingLR
T_Max: 100
eta_min: 1e-5
# 软标签配置（核心）
soft_label: False  # 是否使用软标签
soft_label_map:
  5:  # 原始类别（轻度倒伏）
    - [5, 0.6]
    - [4, 0.1]
    - [3, 0.2]
ignore_index: 255  # 忽略的类别索引

# 数据配置
dataset_dir: /root/code/Rice_Segment/DatasetProcessing/synthetic_data
train_images_dir: train/data
train_masks_dir: train/label
val_images_dir: val/data
val_masks_dir: val/label
test_images_dir: test/data
test_masks_dir: test/label
input_size: 640
load_on_ram: False
# 预测配置
checkpoint_path: /root/code/Rice_Segment/Segment_v2/logs/DJ/Stack_All/Segformer/mit_b0/version_7/checkpoints/best_model-epoch=0-val/IoU=0.0-val/acc=0.14299194514751434.ckpt
resume: False

# 模型配置
arch: segformer
encoder: mit_b0
pretrained: imagenet
in_channels: 55
num_classes: 7
class_names: [road, sugarcane, rice_normal, rice_severe, rice_mild, weed, abnormal]
IoU_index: [3,4,6]  # 评价指标，Index对应class_names中的索引，用以计算评价指标
# 硬件配置
gpus: 1
precision: 16  # 精度模式，Double precision (64), full precision (32), half precision (16) or bfloat16 precision (bf16). Can be used on CPU, GPU, TPUs, HPUs or IPUs. Default: ``32``.
